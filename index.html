<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Leaderboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: #3e3e3e; color: #f0f0f0; padding: 20px; }
    h1, h2 { color: #f0f0f0; }
    .board { background: #2c2c2c; padding: 20px; border-radius: 10px; margin-bottom: 30px; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
    .row { margin-bottom: 15px; }
    .name { font-weight: bold; margin-bottom: 5px; }
    .bar-container { width: 100%; background: #444; border-radius: 5px; overflow: hidden; height: 25px; display: flex; }
    .rsg { background: #4287f5; height: 100%; color: white; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: width 1s ease; }
    .k5 { background: #f54291; height: 100%; color: white; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: width 1s ease; }
	h4 { text-decoration: underline; }
  </style>
</head>
<body>

<h1 style="text-align: center;">Leaderboard</h1>
<h3>A run is the total time added from an Any% Glitchless run (IGT) to the time of an IRL 5 kilometer race.</h3>

<label>Date : <input type="date" id="dateFilter" /></label>
<br/><br/>
<label>Show x runs : <input type="number" id="topX" value="10" min="1" /></label>

<h4>You can reset infinitely until you get the run that suits you, then run the 5K.</h4>
<div class="board" id="leftBoard">
  <h2>RSG + 5K</h2>
</div>

<h4>First you have to run the 5K and then play the first seed generated by the game.</h4>
<div class="board" id="rightBoard">
  <h2>5K + RSG</h2>
</div>

<script>
function parseTime(t) {
  return t.h*3600000 + t.m*60000 + t.s*1000 + t.ms;
}
function formatTime(ms) {
  const h = Math.floor(ms/3600000); ms%=3600000;
  const m = Math.floor(ms/60000); ms%=60000;
  const s = Math.floor(ms/1000); ms%=1000;
  return `${h}h ${m}m ${s}s ${ms}ms`;
}

const runsRsg5k = [
  { name: "Antoine", date: "2025-11-23", version:"1.16.1", f3:"F3", country:"FR", mods:"Modded", difficulty:"Easy", rsg:{h:0,m:19,s:38,ms:397}, k5:{h:0,m:31,s:24,ms:0} },
  { name: "LudovikMC", date: "2025-11-27", version:"1.16.1", f3:"No F3", country:"FR", mods:"Modded", difficulty:"Hardcore", rsg:{h:0,m:25,s:5,ms:576}, k5:{h:0,m:22,s:13,ms:0} }
];
const runs5kRsg = [
  { name: "LudovikMC", date: "2025-11-23", version:"1.16.1", f3:"No F3", country:"FR", mods:"Modded", difficulty:"Hard", rsg:{h:0,m:48,s:1,ms:62}, k5:{h:0,m:19,s:57,ms:0} },
  { name: "LudovikMC", date: "2025-11-26", version:"1.16.1", f3:"No F3", country:"FR", mods:"Modded", difficulty:"Hard", rsg:{h:0,m:37,s:30,ms:681}, k5:{h:0,m:26,s:34,ms:0} },
];

function getMaxTotal(list) {
  return Math.max(...list.map(r => parseTime(r.rsg)+parseTime(r.k5)));
}

function sortByTotalTime(list) {
  return list.slice().sort((a,b) => (parseTime(a.rsg)+parseTime(a.k5)) - (parseTime(b.rsg)+parseTime(b.k5)) );
}

function renderBoard(list, containerId, firstKey, secondKey, maxGlobal) {
  const board = document.getElementById(containerId);
  board.querySelectorAll('.row').forEach(e => e.remove());
  if (list.length === 0) return;

  list.forEach((p, index) => {
    const t1 = parseTime(p[firstKey]);
    const t2 = parseTime(p[secondKey]);
    const total = t1 + t2;

    const row = document.createElement('div'); 
    row.className = 'row';
    row.style.display = 'flex';
    row.style.alignItems = 'flex-start';

    // Rang
    const rankDiv = document.createElement('div');
    const suffix = (n) => n===1?'st':n===2?'nd':n===3?'rd':'th';
    rankDiv.textContent = `${index+1}${suffix(index+1)}`;
    rankDiv.style.width = '40px';
    rankDiv.style.fontWeight = 'bold';
    rankDiv.style.marginRight = '10px';

    // Ligne info du joueur (au-dessus)
    const infoRow = document.createElement('div');
    infoRow.className = 'name';
    infoRow.textContent = `${p.name}     ${p.version}     ${p.f3}     ${p.date}     ${p.country}     ${p.mods}     ${p.difficulty}`;
    infoRow.style.whiteSpace = "pre";
    infoRow.style.marginBottom = '5px';

    // Ligne barre + temps total
    const barRow = document.createElement('div');
    barRow.style.display = 'flex';
    barRow.style.alignItems = 'center';
    barRow.style.justifyContent = 'space-between';

    const bar = document.createElement('div'); 
    bar.className = 'bar-container';
	const pxPerMs = 0.0003;
	bar.style.width = ((t1 + t2) * pxPerMs) + 'px';
    
    const firstBar = document.createElement('div'); 
    firstBar.className = firstKey==='rsg'?'rsg':'k5';
    firstBar.style.width = (t1/total*100)+'%';
    firstBar.textContent = formatTime(t1);

    const secondBar = document.createElement('div'); 
    secondBar.className = secondKey==='rsg'?'rsg':'k5';
    secondBar.style.width = (t2/total*100)+'%';
    secondBar.textContent = formatTime(t2);

    bar.appendChild(firstBar);
    bar.appendChild(secondBar);

    const totalDiv = document.createElement('div');
    totalDiv.textContent = formatTime(total);
    totalDiv.style.whiteSpace = 'nowrap';
    totalDiv.style.marginLeft = '10px';

    barRow.appendChild(bar);
    barRow.appendChild(totalDiv);

    // Colonne principale (infos + barre)
    const mainCol = document.createElement('div');
    mainCol.style.flex = '1';
    mainCol.appendChild(infoRow);
    mainCol.appendChild(barRow);

    // Ajout Ã  la row
    row.appendChild(rankDiv);
    row.appendChild(mainCol);
    board.appendChild(row);
  });
}

function applyFilter() {
  const date = document.getElementById('dateFilter').value;
  const topX = parseInt(document.getElementById('topX').value) || 10;

  const f1 = sortByTotalTime(runsRsg5k.filter(r => !date || r.date <= date)).slice(0, topX);
  const f2 = sortByTotalTime(runs5kRsg.filter(r => !date || r.date <= date)).slice(0, topX);

  const maxLeft = getMaxTotal(f1);
  const maxRight = getMaxTotal(f2);

  renderBoard(f1, 'leftBoard', 'rsg', 'k5', maxLeft);
  renderBoard(f2, 'rightBoard', 'k5', 'rsg', maxRight);
}

window.addEventListener('DOMContentLoaded', applyFilter);

document.getElementById('dateFilter').addEventListener('change', applyFilter);
document.getElementById('topX').addEventListener('input', applyFilter);
</script>

</body>

</html>





